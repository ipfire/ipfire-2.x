From: Jeff Mahoney <jeffm@suse.com>
Subject: [PATCH] reiserfs: eliminate reiserfs_warning from uniqueness functions

 uniqueness2type and type2uniquness issue a warning when the value is
 unknown. When called from reiserfs_warning, this causes a re-entrancy
 problem and deadlocks on the error buffer lock.

Signed-off-by: Jeff Mahoney <jeffm@suse.com>
---
 include/linux/reiserfs_fs.h |    7 ++-----
 1 file changed, 2 insertions(+), 5 deletions(-)

--- a/include/linux/reiserfs_fs.h
+++ b/include/linux/reiserfs_fs.h
@@ -560,10 +560,8 @@ static inline int uniqueness2type(__u32 
 		return TYPE_DIRECT;
 	case V1_DIRENTRY_UNIQUENESS:
 		return TYPE_DIRENTRY;
-	default:
-		reiserfs_warning(NULL, "vs-500", "unknown uniqueness %d",
-				 uniqueness);
 	case V1_ANY_UNIQUENESS:
+	default:
 		return TYPE_ANY;
 	}
 }
@@ -580,9 +578,8 @@ static inline __u32 type2uniqueness(int 
 		return V1_DIRECT_UNIQUENESS;
 	case TYPE_DIRENTRY:
 		return V1_DIRENTRY_UNIQUENESS;
-	default:
-		reiserfs_warning(NULL, "vs-501", "unknown type %d", type);
 	case TYPE_ANY:
+	default:
 		return V1_ANY_UNIQUENESS;
 	}
 }
