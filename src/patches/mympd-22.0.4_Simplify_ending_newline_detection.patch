From c6eeec3614bd6e91f3313f37a723a2b37467ec6a Mon Sep 17 00:00:00 2001
From: jcorporation <mail@jcgames.de>
Date: Fri, 10 Oct 2025 15:45:06 +0200
Subject: [PATCH] Fix: Simplify ending newline detection #1470

---
 build.sh | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/build.sh b/build.sh
index 366e3e619..1f20fcdb0 100755
--- a/build.sh
+++ b/build.sh
@@ -217,7 +217,7 @@ createassets() {
     [ "$F" = "js/long-press-event.js" ] && continue
     [ "$F" = "js/version.js" ] && continue
     JSSRCFILES="$JSSRCFILES htdocs/$F"
-    if tail -1 "htdocs/$F" | perl -npe 'exit 1 if m/\n/; exit 0'
+    if [ -n "$(tail -c 1 "htdocs/$F")" ]
     then
       echo_error "$F don't end with newline character"
       exit 1
@@ -241,7 +241,7 @@ createassets() {
   JSFILES="$JSFILES $MYMPD_BUILDDIR/htdocs/js/*.min.js"
   for F in $JSFILES
   do
-    if tail -1 "$F" | perl -npe 'exit 1 if m/\n/; exit 0'
+    if [ -n "$(tail -c 1 "$F")" ]
     then
       echo_error "$F don't end with newline character"
       exit 1

